/**
* SignWriting 2010 JavaScript Library v1.6.1
* https://github.com/Slevinski/sw10js
* Copyright (c) 2007-2015, Stephen E Slevinski Jr
* sw10.min.js is released under the MIT License.
*/
var sw10=signwriting_2010={key:function(e,t){var a=e.match(/S[123][0-9a-f]{2}[0-5][0-9a-f]([0-9]{3}x[0-9]{3})?/g);return a?a[0]+(t?this.styling(e):""):""},fsw:function(e,t){{var a=e.match(/(A(S[123][0-9a-f]{2}[0-5][0-9a-f])+)?[BLMR]([0-9]{3}x[0-9]{3})(S[123][0-9a-f]{2}[0-5][0-9a-f][0-9]{3}x[0-9]{3})*|S38[7-9ab][0-5][0-9a-f][0-9]{3}x[0-9]{3}/);this.styling(e)}return a?a[0]+(t?this.styling(e):""):""},styling:function(e){var t=e.match(/-C?(P[0-9]{2})?(G\(([0-9a-fA-F]{3}([0-9a-fA-F]{3})?|[a-zA-Z]+)\))?(D\(([0-9a-fA-F]{3}([0-9a-fA-F]{3})?|[a-zA-Z]+)(,([0-9a-fA-F]{3}([0-9a-fA-F]{3})?|[a-zA-Z]+))?\))?(Z[0-9]+(\.[0-9]+)?)?(\+(D[0-9]{2}\(([0-9a-fA-F]{3}([0-9a-fA-F]{3})?|[a-zA-Z]+)(,([0-9a-fA-F]{3}([0-9a-fA-F]{3})?|[a-zA-Z]+))?\))*(Z[0-9]{2},[0-9]+(\.[0-9]+)?(,[0-9]{3}x[0-9]{3})?)*)?/);return t?t[0]:""},mirror:function(e){if(e=this.key(e),!this.size(e))return"";var t,a=e.slice(0,4),r=e.slice(4,5),s=parseInt(e.slice(5,6),16),i=a+"08",n=a+"18";for(this.size(i)||this.size(n)?t=8:((0==s||4==s)&&(t=0),(1==s||5==s)&&(t=6),(2==s||6==s)&&(t=4),(3==s||7==s)&&(t=2)),e="";!this.size(e);)s+=t,s>7&&8>t&&(s-=8),s>15&&(s-=16),e=a+r+s.toString(16);return e},fill:function(e,t){if(e=this.key(e),!this.size(e))return"";-1!=t&&(t=1);var a=e.slice(0,4),r=parseInt(e.slice(4,5)),s=e.slice(5,6);for(e="";!this.size(e);)r+=t,r>5&&(r=0),0>r&&(r=5),e=a+r+s;return e},rotate:function(e,t){if(e=this.key(e),!this.size(e))return"";-1!=t&&(t=1);var a=e.slice(0,4),r=e.slice(4,5),s=parseInt(e.slice(5,6),16);for(e="";!this.size(e);)s>7?(s+=t,s>15&&(s=8),8>s&&(s=15),e=a+r+s.toString(16)):(s-=t,s>7&&(s=0),0>s&&(s=7),e=a+r+s);return e},scroll:function(e,t){if(e=this.key(e),!this.size(e))return"";-1!=t&&(t=1);var a=parseInt(e.slice(1,4),16)+t,r=e.slice(4,5),s=e.slice(5,6),i="S"+a.toString(16)+r+s;return this.size(i)?i:e},structure:function(e,t,a){var r={kind:["S100","S37f","S387"],category:["S100","S205","S2f7","S2ff","S36d","S37f","S387"],group:["S100","S10e","S11e","S144","S14c","S186","S1a4","S1ba","S1cd","S1f5","S205","S216","S22a","S255","S265","S288","S2a6","S2b7","S2d5","S2e3","S2f7","S2ff","S30a","S32a","S33b","S359","S36d","S376","S37f","S387"]},s=r[e];if(!s)return t?"is"==a?!1:"":[];if(!t&&!a)return s;a||(a="");var n;switch(a){case"is":return-1==s.indexOf(t.slice(0,4))?!1:!0;case"first":return s[0];case"last":return s.slice(-1)[0];case"prev":n=-2;break;case"":n=-1;break;case"next":n=0;break;default:return""}var f=s.length;for(i=0;i<s.length;i++)if(parseInt(t.slice(1,4),16)<parseInt(s[i].slice(1,4),16)){f=i;break}return f+=n,f=0>f?0:f>=s.length?s.length-1:f,s[f]},type:function(e){var t,a;switch(e){case"writing":t="100",a="37e";break;case"hand":t="100",a="204";break;case"movement":t="205",a="2f6";break;case"dynamic":t="2f7",a="2fe";break;case"head":case"hcenter":t="2ff",a="36c";break;case"vcenter":t="2ff",a="375";break;case"trunk":t="36d",a="375";break;case"limb":t="376",a="37e";break;case"location":t="37f",a="386";break;case"punctuation":t="387",a="38b";break;default:t="100",a="38b"}return[t,a]},is:function(e,t){if(6==e.length&&!this.size(e))return!1;var a=this.type(t),r=a[0],s=a[1],i=e.slice(1,4);return parseInt(r,16)<=parseInt(i,16)&&parseInt(s,16)>=parseInt(i,16)},filter:function(e,t){var a=this.type(t),r=a[0],s=a[1],i="S"+this.range(r,s,1)+"[0-5][0-9a-f][0-9]{3}x[0-9]{3}",n=e.match(RegExp(i,"g"));return n?n.join(""):""},random:function(e){var t=this.type(e),a=t[0],r=t[1],s=Math.floor(Math.random()*(parseInt(r,16)-parseInt(a,16)+1)+parseInt(a,16)),i=Math.floor(6*Math.random()),n=Math.floor(16*Math.random()),f="S"+s.toString(16)+i.toString(16)+n.toString(16);return this.size(f)?f:this.random(e)},colorize:function(e){var t="000000";return this.is(e,"hand")&&(t="0000CC"),this.is(e,"movement")&&(t="CC0000"),this.is(e,"dynamic")&&(t="FF0099"),this.is(e,"head")&&(t="006600"),this.is(e,"location")&&(t="884411"),this.is(e,"punctuation")&&(t="FF9900"),t},view:function(e,t){if(!this.is(e))return"";var a=e.slice(0,4);return t?a+(this.size(a+"00")?"0":"1")+"0":a+(this.is(a,"hand")&&!this.structure("group",a,"is")?"1":"0")+"0"},code:function(e,t){var a,r=this.fsw(e);if(r){var s="S[123][0-9a-f]{2}[0-5][0-9a-f]",n=r.match(RegExp(s,"g"));for(i=0;i<n.length;i++)a=n[i],r=r.replace(a,this.code(a,t));return r}if(a=this.key(e),!a)return"";var f=1048576+96*(parseInt(a.slice(1,4),16)-256)+16*parseInt(a.slice(4,5),16)+parseInt(a.slice(5,6),16)+1;return t?f.toString(16).toUpperCase():String.fromCharCode(55296+(f-65536>>10),56320+(f-65536&1023))},uni8:function(e,t){var a,r=this.fsw(e);if(r){var s="S[123][0-9a-f]{2}[0-5][0-9a-f]",n=r.match(RegExp(s,"g"));for(i=0;i<n.length;i++)a=n[i],r=r.replace(a,this.uni8(a,t));return r}if(a=this.key(e),!a)return"";var f=parseInt(a.substr(1,3),16)+parseInt("1D700",16),c=t?f.toString(16).toUpperCase():String.fromCharCode(55296+(f-65536>>10),56320+(f-65536&1023)),l=a.substr(4,1);"0"!=l&&(l=parseInt(l,16)+parseInt("1DA9A",16),c+=t?l.toString(16).toUpperCase():String.fromCharCode(55296+(l-65536>>10),56320+(l-65536&1023)));var h=a.substr(5,1);return"0"!=h&&(h=parseInt(h,16)+parseInt("1DAA0",16),c+=t?h.toString(16).toUpperCase():String.fromCharCode(55296+(h-65536>>10),56320+(h-65536&1023))),c},pua:function(e,t){var a=this.fsw(e);if(a){var r,s,i,n,f;s=parseInt("FD800",16),a=a.replace("A",t?s.toString(16).toUpperCase():String.fromCharCode(55296+(s-65536>>10),56320+(s-65536&1023))),a=a.replace("B",t?(s+1).toString(16).toUpperCase():String.fromCharCode(55296+(s+1-65536>>10),56320+(s+1-65536&1023))),a=a.replace("L",t?(s+2).toString(16).toUpperCase():String.fromCharCode(55296+(s+2-65536>>10),56320+(s+2-65536&1023))),a=a.replace("M",t?(s+3).toString(16).toUpperCase():String.fromCharCode(55296+(s+3-65536>>10),56320+(s+3-65536&1023))),a=a.replace("R",t?(s+4).toString(16).toUpperCase():String.fromCharCode(55296+(s+4-65536>>10),56320+(s+4-65536&1023)));for(var c="[0-9]{3}x[0-9]{3}",l=a.match(RegExp(c,"g")),h=0;h<l.length;h++)r=l[h],i=r.split("x"),i[0]=parseInt(i[0])+parseInt("FDD0C",16),i[1]=parseInt(i[1])+parseInt("FDD0C",16),f=t?i[0].toString(16).toUpperCase():String.fromCharCode(55296+(i[0]-65536>>10),56320+(i[0]-65536&1023)),f+=t?i[1].toString(16).toUpperCase():String.fromCharCode(55296+(i[1]-65536>>10),56320+(i[1]-65536&1023)),a=a.replace(r,f);for(c="S[123][0-9a-f]{2}[0-5][0-9a-f]",l=a.match(RegExp(c,"g")),h=0;h<l.length;h++)n=l[h],a=a.replace(n,this.pua(n,t));return a}var n=this.key(e);if(!n)return"";var p=parseInt(n.substr(1,3),16)+parseInt("FD730",16),f=t?p.toString(16).toUpperCase():String.fromCharCode(55296+(p-65536>>10),56320+(p-65536&1023)),g=n.substr(4,1);g=parseInt(g,16)+parseInt("FD810",16),f+=t?g.toString(16).toUpperCase():String.fromCharCode(55296+(g-65536>>10),56320+(g-65536&1023));var o=n.substr(5,1);return o=parseInt(o,16)+parseInt("FD820",16),f+=t?o.toString(16).toUpperCase():String.fromCharCode(55296+(o-65536>>10),56320+(o-65536&1023))},bbox:function(e){var t,a,r,s,i,n,f=/[0-9]{3}x[0-9]{3}/g,c=e.match(f);if(c){for(var l=0;l<c.length;l++)t=parseInt(c[l].slice(0,3)),a=parseInt(c[l].slice(4,7)),0==l?(r=t,s=t,i=a,n=a):(r=Math.min(r,t),s=Math.max(s,t),i=Math.min(i,a),n=Math.max(n,a));return""+r+" "+s+" "+i+" "+n}return""},displace:function(e,t,a){var r,s,i="[0-9]{3}x[0-9]{3}",n=e.match(RegExp(i,"g"));if(n){for(var f=0;f<n.length;f++)r=parseInt(n[f].slice(0,3))+t,s=parseInt(n[f].slice(4,7))+a,e=e.replace(n[f],r+"X"+s);e=e.replace(/X/g,"x")}return e},sizes:{},size:function(e){var t,a=this.fsw(e);if(a){var r=this.bbox(a);return r=r.split(" "),x1=r[0],x2=r[1],y1=r[2],y2=r[3],t=x2-x1+"x"+(y2-y1),"0x0"==t?"":t}var s=this.key(e);if(!s)return"";if(this.sizes[s])return this.sizes[s];var i,n,f=2,c=76*f;this.canvaser||(this.canvaser=document.createElement("canvas"),this.canvaser.width=c,this.canvaser.height=c);var l=this.canvaser,h=l.getContext("2d");h.clearRect(0,0,c,c),h.font=30*f+"px 'SignWriting 2010'",h.fillText(this.code(s),0,0),i=h.getImageData(0,0,c,c).data;e:for(var p=c-1;p>=0;p--)for(var g=0;c>g;g++)for(var o=0;4>o;o++)if(n=4*p+4*g*c+o,i[n])break e;var u=p;e:for(var g=c-1;g>=0;g--)for(var p=0;u>p;p++)for(var o=0;4>o;o++)if(n=4*p+4*g*c+o,i[n])break e;var S=g+1;if(u=""+Math.ceil(u/f),S=""+Math.ceil(S/f),"S1710d S1711d S1712d S17311 S17321 S17733 S1773f S17743 S1774f S17753 S1775f S16d33 S1713d S1714d S17301 S17329 S1715d".indexOf(s)>-1&&(u="20"),"S24c15 S24c30".indexOf(s)>-1&&(u="22"),"S2903b".indexOf(s)>-1&&(u="23"),"S1d203 S1d233".indexOf(s)>-1&&(u="25"),"S24c15".indexOf(s)>-1&&(u="28"),"S2e629".indexOf(s)>-1&&(u="29"),"S16541 S23425".indexOf(s)>-1&&(u="30"),"S2d316".indexOf(s)>-1&&(u="40"),"S2541a".indexOf(s)>-1&&(u="50"),"S1732f S17731 S17741 S17751".indexOf(s)>-1&&(S="20"),"S1412c".indexOf(s)>-1&&(S="21"),"S2a903".indexOf(s)>-1&&(S="31"),"S2b002".indexOf(s)>-1&&(S="36"),t=u+"x"+S,"0x0"==t){var v="S1000815x30 S1000921x30 S1000a30x15 S1000b30x21 S1000c15x30 S1000d21x30 ",d=v.indexOf(s);if(-1==d)return"";var x=v.indexOf(" ",d);t=v.slice(d+6,x)}return this.sizes[s]=t,t},max:function(e,t){var a=this.type(t),r=a[0],s=a[1],i="S"+this.range(r,s,1)+"[0-5][0-9a-f][0-9]{3}x[0-9]{3}",n=e.match(RegExp(i,"g"));if(n){for(var f,c,l,h,p="",g=0;g<n.length;g++)f=n[g].slice(0,6),c=parseInt(n[g].slice(6,9)),l=parseInt(n[g].slice(10,13)),h=this.size(f).split("x"),p+=f+c+"x"+l+(c+parseInt(h[0]))+"x"+(l+parseInt(h[1]));return p}return""},norm:function(e){var t,a,r,s,i=this.bbox(this.max(e,"hcenter")),n=this.bbox(this.max(e,"vcenter")),f=this.bbox(this.max(e));if(!f)return"";n?(t=parseInt(n.slice(0,3)),a=parseInt(n.slice(4,7))):(t=parseInt(f.slice(0,3)),a=parseInt(f.slice(4,7))),i?(r=parseInt(i.slice(8,11)),s=parseInt(i.slice(12,15))):(r=parseInt(f.slice(8,11)),s=parseInt(f.slice(12,15)));var c=parseInt((t+a)/2),l=parseInt((r+s)/2),h=500-c,p=500-l,g=e.match(/(A(S[123][0-9a-f]{2}[0-5][0-9a-f])+)?[BLMR]/);return g=g?g[0]:"M",e=g+parseInt(f.slice(4,7))+"x"+parseInt(f.slice(12,15))+this.filter(e),this.displace(e,h,p)},svg:function(e,t){var a,r=this.fsw(e),s=this.styling(e);if(!r){var i=this.key(e),a=this.size(i);if(!a)return"";r=6==i.length?i+"500x500":i}if(t||(t={}),t.size=t.size?parseFloat(t.size)||"x":1,t.colorize=t.colorize?!0:!1,t.pad=t.pad?parseInt(t.pad):0,t.line=t.line?/^[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/g.test(t.line)?"#"+t.line:t.line:"black",t.fill=t.fill?/^[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/g.test(t.fill)?"#"+t.fill:t.fill:"white",t.back=t.back?/^[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/g.test(t.back)?"#"+t.back:t.back:"",t.E=[],t.F=[],t.view="key"==t.view?"key":"uni8"==t.view?"uni8":"pua"==t.view?"pua":"code",t.copy="code"==t.copy?"code":"uni8"==t.copy?"uni8":"pua"==t.copy?"pua":"key",s){var n;if(n=s.match(/C/),t.colorize=n?!0:!1,n=s.match(/P[0-9]{2}/),n&&(t.pad=parseInt(n[0].substring(1,n[0].length))),n=s.match(/G\(([0-9a-fA-F]{3}([0-9a-fA-F]{3})?|[a-zA-Z]+)\)/)){var f=n[0].substring(2,n[0].length-1);t.back=/^[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/g.test(f)?"#"+f:f}if(stylings=s.split("+"),n=stylings[0].match(/D\(([0-9a-f]{3}([0-9a-f]{3})?|[a-zA-Z]+)(,([0-9a-f]{3}([0-9a-f]{3})?|[a-zA-Z]+))?\)/)){var c=n[0].substring(2,n[0].length-1).split(",");c[0]&&(t.line=/^[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/g.test(c[0])?"#"+c[0]:c[0]),c[1]&&(t.fill=/^[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/g.test(c[1])?"#"+c[1]:c[1])}if(n=stylings[0].match(/Z[0-9]+(\.[0-9]+)?/),n&&(t.size=n[0].substring(1,n[0].length)),stylings[1]||(stylings[1]=""),n=stylings[1].match(/D[0-9]{2}\(([0-9a-f]{3}([0-9a-f]{3})?|[a-wyzA-Z]+)(,([0-9a-f]{3}([0-9a-f]{3})?|[a-wyzA-Z]+))?\)/g))for(var l=0;l<n.length;l++){var h=parseInt(n[l].substring(1,3)),c=n[l].substring(4,n[l].length-1).split(",");c[0]&&(c[0]=/^[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/g.test(c[0])?"#"+c[0]:c[0]),c[1]&&(c[1]=/^[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/g.test(c[1])?"#"+c[1]:c[1]),t.E[h]=c}if(n=stylings[1].match(/Z[0-9]{2},[0-9]+(\.[0-9]+)?(,[0-9]{3}x[0-9]{3})?/g))for(var l=0;l<n.length;l++){var h=parseInt(n[l].substring(1,3)),p=n[l].substring(4,n[l].length).split(",");p[0]=parseFloat(p[0]),t.F[h]=p}}var g,o,u,S,v,d,x;g=/(A(S[123][0-9a-f]{2}[0-5][0-9a-f])+)?[BLMR]([0-9]{3}x[0-9]{3})(S[123][0-9a-f]{2}[0-5][0-9a-f][0-9]{3}x[0-9]{3})*|S38[7-9ab][0-5][0-9a-f][0-9]{3}x[0-9]{3}/g,o=/S[123][0-9a-f]{2}[0-5][0-9a-f][0-9]{3}x[0-9]{3}/g,u=/[0-9]{3}x[0-9]{3}/g,x={},x.L=-1,x.R=1;var b,I,m,k,F,y,A=500,z=500,w=500,C=500;m=r.charAt(0);var E=this.bbox(r);if(E=E.split(" "),A=parseInt(E[0]),z=parseInt(E[1]),w=parseInt(E[2]),C=parseInt(E[3]),"S"==m)if(500==A&&500==w){var p=a.split("x");z=500+parseInt(p[0]),C=500+parseInt(p[1])}else z=1e3-A,C=1e3-w;v=r.match(o);for(var l=0;l<v.length;l++){if(S=v[l].slice(0,6),b=v[l].slice(6,9),I=v[l].slice(10,13),t.F[l+1]){t.F[l+1][1]&&(b=parseInt(b)+parseInt(t.F[l+1][1].slice(0,3))-500,I=parseInt(I)+parseInt(t.F[l+1][1].slice(4,7))-500,A=Math.min(A,b),w=Math.min(w,I));var M=this.size(S);M&&(M=M.split("x"),z=Math.max(z,parseInt(b)+t.F[l+1][0]*parseInt(M[0])),C=Math.max(C,parseInt(I)+t.F[l+1][0]*parseInt(M[1])))}d='<g transform="translate('+b+","+I+')">',d+="<text ",d+='class="sym-fill" ',t.css||(d+="style=\"pointer-events:none;font-family:'SignWriting 2010 Filling';font-size:"+(t.F[l+1]?30*t.F[l+1][0]:30)+"px;fill:"+(t.E[l+1]&&t.E[l+1][1]?t.E[l+1][1]:t.fill)+";",d+="code"==t.view?"":"-webkit-font-feature-settings:'liga';font-feature-settings:'liga';",d+='"'),d+=">",d+="key"==t.view?S:"uni8"==t.view?this.uni8(S):"pua"==t.view?this.pua(S):this.code(S),d+="</text>",d+="<text ",d+='class="sym-line" ',t.css||(d+='style="',d+=t.view==t.copy?"":"pointer-events:none;",d+="font-family:'SignWriting 2010';font-size:"+(t.F[l+1]?30*t.F[l+1][0]:30)+"px;fill:"+(t.E[l+1]?t.E[l+1][0]:t.colorize?"#"+this.colorize(S):t.line)+";",d+="code"==t.view?"":"-webkit-font-feature-settings:'liga';font-feature-settings:'liga';",d+='"'),d+=">",d+="key"==t.view?S:"uni8"==t.view?this.uni8(S):"pua"==t.view?this.pua(S):this.code(S),d+="</text>",d+="</g>",v[l]=d}A-=t.pad,z+=t.pad,w-=t.pad,C+=t.pad,k=z-A,F=C-w,y=x[m]||0,y=75*y+A-400;var R='<svg xmlns="http://www.w3.org/2000/svg" ';return t["class"]&&(R+='class="'+t["class"]+'" '),"x"!=t.size&&(R+='width="'+k*t.size+'" height="'+F*t.size+'" '),R+='viewBox="'+A+" "+w+" "+k+" "+F+'">',t.view!=t.copy&&(R+='<text style="font-size:0%;">',R+="code"==t.copy?this.code(e):"uni8"==t.copy?this.uni8(e):"pua"==t.copy?this.pua(e):e,R+="</text>"),t.back&&(R+='  <rect x="'+A+'" y="'+w+'" width="'+k+'" height="'+F+'" style="fill:'+t.back+';" />'),R+=v.join("")+"</svg>",t.laned&&(R='<div style="padding:10px;position:relative;width:'+k+"px;height:"+F+"px;left:"+y+'px;">'+R+"</div>"),R},canvas:function(e,t){var a,r=document.createElement("canvas"),s=this.fsw(e,!0),i=this.styling(e);if(!s){var n=this.key(e),a=this.size(n);if(!n)return"";s=6==n.length?n+"500x500":n}if(t||(t={}),t.size=t.size?parseFloat(t.size):1,t.colorize=t.colorize?!0:!1,t.pad=t.pad?parseInt(t.pad):0,t.line=t.line?/^[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/g.test(t.line)?"#"+t.line:t.line:"black",t.fill=t.fill?/^[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/g.test(t.fill)?"#"+t.fill:t.fill:"white",t.back=t.back?/^[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/g.test(t.back)?"#"+t.back:t.back:"",t.E=[],t.F=[],i){var f;if(f=i.match(/C/),t.colorize=f?!0:!1,f=i.match(/P[0-9]{2}/),f&&(t.pad=parseInt(f[0].substring(1,f[0].length))),f=i.match(/G\(([0-9a-fA-F]{3}([0-9a-fA-F]{3})?|[a-zA-Z]+)\)/)){var c=f[0].substring(2,f[0].length-1);t.back=/^[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/g.test(c)?"#"+c:c}if(stylings=i.split("+"),f=stylings[0].match(/D\(([0-9a-f]{3}([0-9a-f]{3})?|[a-zA-Z]+)(,([0-9a-f]{3}([0-9a-f]{3})?|[a-zA-Z]+))?\)/)){var l=f[0].substring(2,f[0].length-1).split(",");l[0]&&(t.line=/^[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/g.test(l[0])?"#"+l[0]:l[0]),l[1]&&(t.fill=/^[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/g.test(l[1])?"#"+l[1]:l[1])}if(f=stylings[0].match(/Z[0-9]+(\.[0-9]+)?/),f&&(t.size=f[0].substring(1,f[0].length)),stylings[1]||(stylings[1]=""),f=stylings[1].match(/D[0-9]{2}\(([0-9a-f]{3}([0-9a-f]{3})?|[a-wyzA-Z]+)(,([0-9a-f]{3}([0-9a-f]{3})?|[a-wyzA-Z]+))?\)/g))for(var h=0;h<f.length;h++){var p=parseInt(f[h].substring(1,3)),l=f[h].substring(4,f[h].length-1).split(",");l[0]&&(l[0]=/^[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/g.test(l[0])?"#"+l[0]:l[0]),l[1]&&(l[1]=/^[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/g.test(l[1])?"#"+l[1]:l[1]),t.E[p]=l}if(f=stylings[1].match(/Z[0-9]{2},[0-9]+(\.[0-9]+)?(,[0-9]{3}x[0-9]{3})?/g))for(var h=0;h<f.length;h++){var p=parseInt(f[h].substring(1,3)),g=f[h].substring(4,f[h].length).split(",");g[0]=parseFloat(g[0]),t.F[p]=g}}var o,u,S,v,d,x;o=/(A(S[123][0-9a-f]{2}[0-5][0-9a-f])+)?[BLMR]([0-9]{3}x[0-9]{3})(S[123][0-9a-f]{2}[0-5][0-9a-f][0-9]{3}x[0-9]{3})*|S38[7-9ab][0-5][0-9a-f][0-9]{3}x[0-9]{3}/g,u=/S[123][0-9a-f]{2}[0-5][0-9a-f][0-9]{3}x[0-9]{3}/g,S=/[0-9]{3}x[0-9]{3}/g,x={},x.L=-1,x.R=1;var b,I,m,k,F,y=500,A=500,z=500,w=500;m=s.charAt(0);var C=this.bbox(s);if(C=C.split(" "),y=parseInt(C[0]),A=parseInt(C[1]),z=parseInt(C[2]),w=parseInt(C[3]),"S"==m)if(500==y&&500==z){var g=a.split("x");A=500+parseInt(g[0]),w=500+parseInt(g[1])}else A=1e3-y,w=1e3-z;d=s.match(u);for(var h=0;h<d.length;h++)if(v=d[h].slice(0,6),b=d[h].slice(6,9),I=d[h].slice(10,13),t.F[h+1]){t.F[h+1][1]&&(b=parseInt(b)+parseInt(t.F[h+1][1].slice(0,3))-500,I=parseInt(I)+parseInt(t.F[h+1][1].slice(4,7))-500,y=Math.min(y,b),z=Math.min(z,I));var E=this.size(v);E&&(E=E.split("x"),A=Math.max(A,parseInt(b)+t.F[h+1][0]*parseInt(E[0])),w=Math.max(w,parseInt(I)+t.F[h+1][0]*parseInt(E[1])))}y-=t.pad,A+=t.pad,z-=t.pad,w+=t.pad;var k=(A-y)*t.size,F=(w-z)*t.size;r.width=k,r.height=F;var M=r.getContext("2d");t.back&&(M.rect(0,0,k,F),M.fillStyle=t.back,M.fill()),d=s.match(u);for(var h=0;h<d.length;h++){if(v=d[h].slice(0,6),b=d[h].slice(6,9),I=d[h].slice(10,13),t.F[h+1]){t.F[h+1][1]&&(b=parseInt(b)+parseInt(t.F[h+1][1].slice(0,3))-500,I=parseInt(I)+parseInt(t.F[h+1][1].slice(4,7))-500,y=Math.min(y,b),z=Math.min(z,I));var E=this.size(v);E&&(E=E.split("x"),A=Math.max(A,parseInt(b)+t.F[h+1][0]*parseInt(E[0])),w=Math.max(w,parseInt(I)+t.F[h+1][0]*parseInt(E[1])))}M.font=(t.F[h+1]?30*t.size*t.F[h+1][0]:30*t.size)+"px 'SignWriting 2010 Filling'",M.fillStyle=t.E[h+1]&&t.E[h+1][1]?t.E[h+1][1]:t.fill,M.fillText(this.code(v),(b-y)*t.size,(I-z)*t.size),M.font=(t.F[h+1]?30*t.size*t.F[h+1][0]:30*t.size)+"px 'SignWriting 2010'",M.fillStyle=t.E[h+1]?t.E[h+1][0]:t.colorize?"#"+this.colorize(v):t.line,M.fillText(this.code(v),(b-y)*t.size,(I-z)*t.size)}return r},png:function(e,t){if(this.fsw(e,!0)||this.key(e,!0)){var a=this.canvas(e,t),r=a.toDataURL("image/png");return a.remove(),r}return""},query:function(e){var e=e.match(/Q((A(S[123][0-9a-f]{2}[0-5u][0-9a-fu]|R[123][0-9a-f]{2}t[123][0-9a-f]{2})+)?T)?((R[123][0-9a-f]{2}t[123][0-9a-f]{2}([0-9]{3}x[0-9]{3})?)|(S[123][0-9a-f]{2}[0-5u][0-9a-fu]([0-9]{3}x[0-9]{3})?))*(V[0-9]+)?/);return e?e[0]:""},range:function(e,t,a){var r,s,i,n,f,c,l;if(a||(a=""),e=("000"+e).slice(-3),t=""+t,r="",e===t)return e;if(s=[],(e[0]!=t[0]||e[1]!=t[1])&&"0"!=e[2])if(r=e[0]+e[1],a){switch(e[2]){case"f":r+="f";break;case"e":r+="[ef]";break;case"d":case"c":case"b":case"a":r+="["+e[2]+"-f]";break;default:switch(e[2]){case"9":r+="[9a-f]";break;case"8":r+="[89a-f]";break;default:r+="["+e[2]+"-9a-f]"}}i=15-parseInt(e[2],16)+1,e=""+(parseInt(e,16)+i).toString(16),s.push(r)}else{switch(e[2]){case"9":r+="9";break;case"8":r+="[89]";break;default:r+="["+e[2]+"-9]"}i=9-e[2]+1,e=""+(1*e+i),s.push(r)}if(r="",e[0]!=t[0]&&"0"!=e[1])if(a){switch(r=e[0],e[1]){case"f":r+="f";break;case"e":r+="[ef]";break;case"d":case"c":case"b":case"a":r+="["+e[1]+"-f]";break;case"9":r+="[9a-f]";break;case"8":r+="[89a-f]";break;default:r+="["+e[1]+"-9a-f]"}r+="[0-9a-f]",i=15-parseInt(e[1],16)+1,e=""+(parseInt(e,16)+16*i).toString(16),s.push(r)}else{switch(r=e[0],i=9-e[1]+1,e[1]){case"9":r+="9";break;case"8":r+="[89]";break;default:r+="["+e[1]+"-9]"}r+="[0-9]",i=9-e[1]+1,e=""+(1*e+10*i),s.push(r)}if(r="",e[0]!=t[0])if(a){switch(i=parseInt(t[0],16)-parseInt(e[0],16),n=(parseInt(e[0],16)+i-1).toString(16),i){case 1:r=e[0];break;case 2:r="["+e[0]+n+"]";break;default:switch(c=parseInt(e[0],16)>9?"h":"d",l=parseInt(n,16)>9?"h":"d",c+l){case"dd":r+="["+e[0]+"-"+n+"]";break;case"dh":switch(i=9-e[0]){case 0:r+="[9";break;case 1:r+="[89";break;default:r+="["+e[0]+"-9"}switch(n[0]){case"a":r+="a]";break;case"b":r+="ab]";break;default:r+="a-"+n+"]"}break;case"hh":r+="["+e[0]+"-"+n+"]"}}r+="[0-9a-f][0-9a-f]",i=parseInt(t[0],16)-parseInt(e[0],16),e=""+(parseInt(e,16)+256*i).toString(16),s.push(r)}else{switch(i=t[0]-e[0],n=1*e[0]+i-1,i){case 1:r=e[0];break;case 2:r="["+e[0]+n+"]";break;default:r="["+e[0]+"-"+n+"]"}r+="[0-9][0-9]",e=""+(1*e+100*i),s.push(r)}if(r="",e[1]!=t[1])if(a){switch(i=parseInt(t[1],16)-parseInt(e[1],16),n=(parseInt(e[1],16)+i-1).toString(16),r=e[0],i){case 1:r+=e[1];break;case 2:r+="["+e[1]+n+"]";break;default:switch(c=parseInt(e[1],16)>9?"h":"d",l=parseInt(n,16)>9?"h":"d",c+l){case"dd":r+="["+e[1],i>1&&(r+="-"),r+=n+"]";break;case"dh":switch(i=9-e[1]){case 0:r+="[9";break;case 1:r+="[89";break;default:r+="["+e[1]+"-9"}switch(t[1]){case"a":r+="]";break;case"b":r+="a]";break;default:r+="a-"+(parseInt(t[1],16)-1).toString(16)+"]"}break;case"hh":r+="["+e[1],i>1&&(r+="-"),r+=(parseInt(t[1],16)-1).toString(16)+"]"}}r+="[0-9a-f]",i=parseInt(t[1],16)-parseInt(e[1],16),e=""+(parseInt(e,16)+16*i).toString(16),s.push(r)}else{switch(i=t[1]-e[1],n=1*e[1]+i-1,r=e[0],i){case 1:r+=e[1];break;case 2:r+="["+e[1]+n+"]";break;default:r+="["+e[1]+"-"+n+"]"}r+="[0-9]",e=""+(1*e+10*i),s.push(r)}if(r="",e[2]!=t[2])if(a){switch(r=e[0]+e[1],i=parseInt(t[2],16)-parseInt(e[2],16),c=parseInt(e[2],16)>9?"h":"d",l=parseInt(t[2],16)>9?"h":"d",c+l){case"dd":r+="["+e[2],i>1&&(r+="-"),r+=t[2]+"]";break;case"dh":switch(i=9-e[2]){case 0:r+="[9";break;case 1:r+="[89";break;default:r+="["+e[2]+"-9"}switch(t[2]){case"a":r+="a]";break;case"b":r+="ab]";break;default:r+="a-"+t[2]+"]"}break;case"hh":r+="["+e[2],i>1&&(r+="-"),r+=t[2]+"]"}i=parseInt(t[2],16)-parseInt(e[2],16),e=""+(parseInt(e,16)+i).toString(16),s.push(r)}else{switch(i=t[2]-e[2],r=e[0]+e[1],i){case 0:r+=e[2];break;case 1:r+="["+e[2]+t[2]+"]";break;default:r+="["+e[2]+"-"+t[2]+"]"}e=""+(1*e+i),s.push(r)}return r="","0"==e[2]&&"0"==t[2]&&(r=t,s.push(r)),r="",f=s.length,1==f?r=s[0]:(r=s.join(")|("),r="(("+r+"))"),r},regex:function(e,t){if(e=this.query(e),!e)return"";var a,r,s,i,n,f,c,l,h,p,g;t||(t=20);var o,u="S[123][0-9a-f]{2}[0-5][0-9a-f]",S="[0-9]{3}x[0-9]{3}",v="[BLMR]("+S+")("+u+S+")*",d="(A("+u+")+)",x="R[123][0-9a-f]{2}t[123][0-9a-f]{2}",b="S[123][0-9a-f]{2}[0-5u][0-9a-fu]",I="([0-9]{3}x[0-9]{3})?",m="(V[0-9]+)";if(e=this.query(e),!e)return"";if("Q"==e)return[d+"?"+v];if("QT"==e)return[d+v];var k=[],F=e.indexOf("T")+1;if(F){o="(A";var y=e.slice(0,F);if(e=e.replace(y,""),"QT"==y)o+="("+u+")+)";else{var A=y.match(RegExp("("+b+"|"+x+")","g"));if(A){for(var z=0;z<A.length;z++){var w=A[z].match(RegExp(b));w?(f=w[0].slice(0,4),p=w[0].slice(4,5),f+="u"==p?"[0-5]":p,g=w[0].slice(5,6),f+="u"==g?"[0-9a-f]":g,o+=f):(s=A[z].slice(1,4),i=A[z].slice(5,8),n=this.range(s,i,"hex"),f="S"+n+"[0-5][0-9a-f]",o+=f)}o+="("+u+")*)"}}}var A=e.match(RegExp(m,"g"));A&&(t=1*A.toString().slice(1)),a=b+I;var A=e.match(RegExp(a,"g"));if(A)for(var z=0;z<A.length;z++)r=A[z].toString(),h=r.slice(1,4),f="S"+h,p=r.slice(4,5),f+="u"==p?"[0-5]":p,g=r.slice(5,6),f+="u"==g?"[0-9a-f]":g,r.length>6?(c=1*r.slice(6,9),l=1*r.slice(10,13),f+=this.range(c-t,c+t),f+="x",f+=this.range(l-t,l+t)):f+=S,f=v+f+"("+u+S+")*",f=F?o+f:d+"?"+f,k.push(f);a=x+I;var A=e.match(RegExp(a,"g"));if(A)for(var z=0;z<A.length;z++)r=A[z].toString(),s=r.slice(1,4),i=r.slice(5,8),n=this.range(s,i,"hex"),f="S"+n+"[0-5][0-9a-f]",r.length>8?(c=1*r.slice(8,11),l=1*r.slice(12,15),f+=this.range(c-t,c+t),f+="x",f+=this.range(l-t,l+t)):f+=S,f=v+f+"("+u+S+")*",f=F?o+f:d+"?"+f,k.push(f);return k.length||k.push(o+v),k},results:function(e,t,a){if(!t)return[];(-1==="BLMR".indexOf(a)||a.length>1)&&(a="");var r,s,i,n,f=this.regex(e);if(!f)return[];for(var c=0;c<f.length;c++)r=f[c],s=t.match(RegExp(r,"g")),t=s?s.join(" "):"";return t?(a&&(t=t.replace(/B/g,a),t=t.replace(/L/g,a),t=t.replace(/M/g,a),t=t.replace(/R/g,a)),i=t.split(" "),n=i.filter(function(e){return e in this?!1:this[e]=!0},{})):n=[],n},lines:function(e,t,a){if(!t)return[];(-1==="BLMR".indexOf(a)||a.length>1)&&(a="");var r,s,i,n,f=this.regex(e);if(!f)return[];for(var c=0;c<f.length;c++)r=f[c],r="^"+r+".*",s=t.match(RegExp(r,"mg")),t=s?s.join("\n"):"";return t?(a&&(t=t.replace(/B/g,a),t=t.replace(/L/g,a),t=t.replace(/M/g,a),t=t.replace(/R/g,a)),i=t.split("\n"),n=i.filter(function(e){return e in this?!1:this[e]=!0},{})):n=[],n},convert:function(e,t){var a="";if(this.fsw(e)&&/^[eg]?([EG]L?)?$/.test(t)){var r,s,i="S[123][0-9a-f]{2}",n=i+"[0-5][0-9a-f]",f="[0-9]{3}x[0-9]{3}";if((t.indexOf("e")>-1||t.indexOf("g")>-1)&&(r=e.match(RegExp("A("+n+")*","g"))))if(s=r[0],t.indexOf("e")>-1)a+=s+"T";else{r=s.match(RegExp(i,"g")),a+="A";for(var c=0;c<r.length;c++)a+=r[c]+"uu";a+="T"}if((t.indexOf("E")>-1||t.indexOf("G")>-1)&&(r=e.match(RegExp(n+f,"g"))))for(var c=0;c<r.length;c++)a+=t.indexOf("E")>-1?r[c].slice(0,6):r[c].slice(0,4)+"uu",t.indexOf("L")>-1&&(a+=r[c].slice(6,13))}return a?"Q"+a:""}};
